<html>
   <head>
      <script src="view.js"></script>
      <script src="simulation.js"></script>
      <style>
         canvas {
            border: solid black 5px;
            margin: 0;
         }
      </style>
   </head>
   <body>
      <canvas width=700 height=700> </canvas>
      <script>
         
         let canvas = document.querySelector("canvas");
         let ctx = canvas.getContext("2d");
         let simulation = new Simulation(canvas);

         let layers = new LayerDrawer();

         //All camera things
         let camera = new Camera(null, null, layers);
         let dragging = false;
         let lastDrag = null;
         document.addEventListener("mousedown", evt => { 
            dragging = true;
            lastDrag = new Vector(evt.clientX, evt.clientY);
         });
         document.addEventListener("mousemove", evt => {
            if(dragging) {
               let currPos = new Vector(evt.clientX, evt.clientY);
               let drag = currPos.sub(lastDrag);
               lastDrag = currPos;

               camera.translation = camera.translation.add(drag);
            }
         }); 
         document.addEventListener("mouseup", () => dragging = false);
         document.addEventListener("mousewheel", evt => {
            evt.stopPropagation();
            
            let scaling = evt.wheelDeltaY >= 0 ? 1.05 : 0.95;
            camera.scaling = camera.scaling.mult(scaling);
         });

         let v = new Vector(100, 100);
         let associated = {position: new Vector(0,0)};
         let drawable = new VectorDrawable(v, associated);
         layers.add(drawable, 0);

         let t = 0;
         setInterval(() => { 
            t += .05;
            v.set(new Vector(Math.cos(t), Math.sin(t)).mult(100));
            associated.position = v.negate().mult(2);

            camera.draw(ctx);
         }, 10);
      </script>
   </body>
</html>
